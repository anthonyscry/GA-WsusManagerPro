<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- ═══════════════════════════════════════════════════════════════
         WSUS Manager Shared Styles
         Permanent structural styles. All color references use DynamicResource
         so they respond to runtime theme changes.
         ═══════════════════════════════════════════════════════════════ -->

    <!-- ═══════════════════════════════════════════════════════════════
         Button Styles
         ═══════════════════════════════════════════════════════════════ -->

    <!-- NavBtn: Sidebar navigation button -->
    <Style x:Key="NavBtn" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
        <Setter Property="BorderThickness" Value="3,0,0,0"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="Padding" Value="12,8"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="FontSize" Value="13"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- NavBtnActive: Active sidebar navigation button -->
    <Style x:Key="NavBtnActive" TargetType="Button" BasedOn="{StaticResource NavBtn}">
        <Setter Property="Background" Value="{DynamicResource NavActiveBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
    </Style>

    <!-- Btn: Primary action button (green) -->
    <Style x:Key="Btn" TargetType="Button">
        <Setter Property="Background" Value="{DynamicResource ButtonPrimary}"/>
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="16,8"/>
        <Setter Property="FontSize" Value="13"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            CornerRadius="4"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ButtonPrimaryHover}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- BtnSec: Secondary button (outline style) -->
    <Style x:Key="BtnSec" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource BorderPrimary}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="16,8"/>
        <Setter Property="FontSize" Value="13"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- BtnGreen: Success/positive action button -->
    <Style x:Key="BtnGreen" TargetType="Button">
        <Setter Property="Background" Value="{DynamicResource ButtonPrimary}"/>
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="16,8"/>
        <Setter Property="FontSize" Value="13"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            CornerRadius="4"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ButtonPrimaryHover}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- BtnRed: Danger/destructive action button -->
    <Style x:Key="BtnRed" TargetType="Button">
        <Setter Property="Background" Value="{DynamicResource ButtonDanger}"/>
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="16,8"/>
        <Setter Property="FontSize" Value="13"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            CornerRadius="4"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ButtonDangerHover}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- QuickActionBtn: Dashboard quick action button -->
    <Style x:Key="QuickActionBtn" TargetType="Button" BasedOn="{StaticResource BtnSec}">
        <Setter Property="Padding" Value="20,10"/>
        <Setter Property="MinWidth" Value="120"/>
        <Setter Property="FontSize" Value="12"/>
    </Style>

    <!-- ═══════════════════════════════════════════════════════════════
         TextBlock Styles
         ═══════════════════════════════════════════════════════════════ -->

    <Style x:Key="CategoryLabel" TargetType="TextBlock">
        <Setter Property="Foreground" Value="{DynamicResource TextMuted}"/>
        <Setter Property="FontSize" Value="11"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Margin" Value="15,12,0,4"/>
    </Style>

    <Style x:Key="CardTitle" TargetType="TextBlock">
        <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
        <Setter Property="FontSize" Value="12"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
    </Style>

    <Style x:Key="CardValue" TargetType="TextBlock">
        <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
        <Setter Property="FontSize" Value="24"/>
        <Setter Property="FontWeight" Value="Bold"/>
    </Style>

    <Style x:Key="CardSubtext" TargetType="TextBlock">
        <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
        <Setter Property="FontSize" Value="11"/>
    </Style>

    <!-- ═══════════════════════════════════════════════════════════════
         TextBox Styles (Log Panel)
         ═══════════════════════════════════════════════════════════════ -->

    <Style x:Key="LogTextBox" TargetType="TextBox">
        <Setter Property="Background" Value="{DynamicResource PrimaryBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="FontFamily" Value="Consolas"/>
        <Setter Property="FontSize" Value="12"/>
        <Setter Property="IsReadOnly" Value="True"/>
        <Setter Property="TextWrapping" Value="Wrap"/>
        <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
        <Setter Property="HorizontalScrollBarVisibility" Value="Disabled"/>
        <Setter Property="Padding" Value="8"/>
        <Setter Property="CaretBrush" Value="{DynamicResource TextPrimary}"/>
    </Style>

    <!-- ═══════════════════════════════════════════════════════════════
         ProgressBar Dark Style
         ═══════════════════════════════════════════════════════════════ -->

    <Style TargetType="ProgressBar">
        <Setter Property="Background" Value="{DynamicResource PrimaryBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
        <Setter Property="Height" Value="3"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ProgressBar">
                    <Grid x:Name="TemplateRoot">
                        <Border x:Name="PART_Track"
                                Background="{TemplateBinding Background}"
                                CornerRadius="1"/>
                        <Border x:Name="PART_Indicator"
                                Background="{TemplateBinding Foreground}"
                                HorizontalAlignment="Left"
                                CornerRadius="1"/>
                        <!-- Indeterminate animation overlay -->
                        <Rectangle x:Name="Animation"
                                   Fill="{TemplateBinding Foreground}"
                                   Visibility="Collapsed">
                            <Rectangle.RenderTransform>
                                <TranslateTransform x:Name="AnimationTranslate"/>
                            </Rectangle.RenderTransform>
                        </Rectangle>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Determinate"/>
                                <VisualState x:Name="Indeterminate">
                                    <Storyboard RepeatBehavior="Forever">
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="Animation"
                                            Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                Value="{x:Static Visibility.Visible}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="PART_Indicator"
                                            Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                Value="{x:Static Visibility.Collapsed}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames
                                            Storyboard.TargetName="AnimationTranslate"
                                            Storyboard.TargetProperty="X">
                                            <LinearDoubleKeyFrame KeyTime="0" Value="-60"/>
                                            <LinearDoubleKeyFrame KeyTime="0:0:1" Value="180"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames
                                            Storyboard.TargetName="Animation"
                                            Storyboard.TargetProperty="Width">
                                            <DiscreteDoubleKeyFrame KeyTime="0" Value="60"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ═══════════════════════════════════════════════════════════════
         ScrollBar / ScrollViewer Dark Styles
         ═══════════════════════════════════════════════════════════════ -->

    <Style TargetType="ScrollBar">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Width" Value="10"/>
    </Style>

    <!-- ═══════════════════════════════════════════════════════════════
         VIRTUALIZED LIST STYLES (Phase 25: Performance)
         ═══════════════════════════════════════════════════════════════ -->

    <!-- VirtualizedListBox: Base style for large lists (2000+ items)
         Enables UI virtualization so only visible items are rendered.
         Use for Phase 29 Data Filtering panels. -->
    <Style x:Key="VirtualizedListBox" TargetType="ListBox">
        <Setter Property="VirtualizingPanel.IsVirtualizing" Value="True" />
        <Setter Property="VirtualizingPanel.VirtualizationMode" Value="Recycling" />
        <Setter Property="VirtualizingPanel.ScrollUnit" Value="Pixel" />
        <Setter Property="Background" Value="{DynamicResource CardBackground}" />
        <Setter Property="BorderBrush" Value="{DynamicResource BorderPrimary}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Foreground" Value="{DynamicResource TextPrimary}" />
        <Setter Property="FontFamily" Value="Segoe UI" />
        <Setter Property="FontSize" Value="12" />
        <Setter Property="Padding" Value="8" />
    </Style>

    <!-- VirtualizedListView: Extends VirtualizedListBox for column headers
         Use when displaying tabular data with GridView columns. -->
    <Style x:Key="VirtualizedListView" TargetType="ListView" BasedOn="{StaticResource VirtualizedListBox}">
        <Setter Property="GridView.ColumnHeaderContainerStyle">
            <Setter.Value>
                <Style TargetType="GridViewColumnHeader">
                    <Setter Property="Background" Value="{DynamicResource NavBackground}" />
                    <Setter Property="Foreground" Value="{DynamicResource TextSecondary}" />
                    <Setter Property="FontWeight" Value="SemiBold" />
                    <Setter Property="Padding" Value="8,6" />
                    <Setter Property="BorderBrush" Value="{DynamicResource BorderPrimary}" />
                    <Setter Property="BorderThickness" Value="0,0,0,1" />
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
