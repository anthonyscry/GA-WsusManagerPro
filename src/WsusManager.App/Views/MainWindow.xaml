<Window x:Class="WsusManager.App.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WSUS Manager"
        Width="950" Height="736"
        MinWidth="800" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="{StaticResource BgDark}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="180"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ═══════════════════════════════════════════════════════════
             SIDEBAR
             ═══════════════════════════════════════════════════════════ -->
        <Border Grid.Column="0" Background="{StaticResource BgSidebar}"
                BorderBrush="{StaticResource Border}" BorderThickness="0,0,1,0">
            <DockPanel LastChildFill="False">

                <!-- Branding -->
                <StackPanel DockPanel.Dock="Top" Margin="15,16,15,8">
                    <TextBlock Text="WSUS Manager" FontSize="16" FontWeight="Bold"
                               Foreground="{StaticResource Text1}"/>
                    <TextBlock Text="{Binding VersionText}" FontSize="11"
                               Foreground="{StaticResource Text3}" Margin="0,2,0,0"/>
                </StackPanel>

                <Separator DockPanel.Dock="Top" Background="{StaticResource Border}" Margin="15,4"/>

                <!-- SETUP Category -->
                <TextBlock DockPanel.Dock="Top" Text="SETUP" Style="{StaticResource CategoryLabel}"/>
                <Button DockPanel.Dock="Top" Content="Install WSUS"
                        Style="{StaticResource NavBtn}" x:Name="BtnInstall"
                        Command="{Binding NavigateCommand}" CommandParameter="Install"/>

                <!-- TRANSFER Category -->
                <TextBlock DockPanel.Dock="Top" Text="TRANSFER" Style="{StaticResource CategoryLabel}"/>
                <Button DockPanel.Dock="Top" Content="Export / Import"
                        Style="{StaticResource NavBtn}" x:Name="BtnTransfer"
                        Command="{Binding NavigateCommand}" CommandParameter="Transfer"/>

                <!-- MAINTENANCE Category -->
                <TextBlock DockPanel.Dock="Top" Text="MAINTENANCE" Style="{StaticResource CategoryLabel}"/>
                <Button DockPanel.Dock="Top" Content="Online Sync"
                        Style="{StaticResource NavBtn}" x:Name="BtnSync"
                        Command="{Binding NavigateCommand}" CommandParameter="Sync"
                        IsEnabled="{Binding IsOnline}"/>
                <Button DockPanel.Dock="Top" Content="Schedule Task"
                        Style="{StaticResource NavBtn}" x:Name="BtnSchedule"
                        Command="{Binding NavigateCommand}" CommandParameter="Schedule"
                        IsEnabled="{Binding IsOnline}"/>

                <!-- DIAGNOSTICS Category -->
                <TextBlock DockPanel.Dock="Top" Text="DIAGNOSTICS" Style="{StaticResource CategoryLabel}"/>
                <Button DockPanel.Dock="Top" Content="Diagnostics"
                        Style="{StaticResource NavBtn}" x:Name="BtnDiagnostics"
                        Command="{Binding NavigateCommand}" CommandParameter="Diagnostics"/>
                <Button DockPanel.Dock="Top" Content="Deep Cleanup"
                        Style="{StaticResource NavBtn}" x:Name="BtnCleanup"
                        Command="{Binding NavigateCommand}" CommandParameter="Cleanup"/>
                <Button DockPanel.Dock="Top" Content="Restore DB"
                        Style="{StaticResource NavBtn}" x:Name="BtnRestore"
                        Command="{Binding NavigateCommand}" CommandParameter="Restore"/>

                <!-- Bottom utility buttons -->
                <StackPanel DockPanel.Dock="Bottom" Margin="0,0,0,8">
                    <Separator Background="{StaticResource Border}" Margin="15,4"/>
                    <Button Content="Dashboard" Style="{StaticResource NavBtn}"
                            Command="{Binding NavigateCommand}" CommandParameter="Dashboard"/>
                    <Button Content="Settings" Style="{StaticResource NavBtn}"
                            Command="{Binding NavigateCommand}" CommandParameter="Settings"/>
                    <Button Content="Help" Style="{StaticResource NavBtn}"
                            Command="{Binding NavigateCommand}" CommandParameter="Help"/>
                    <Button Content="About" Style="{StaticResource NavBtn}"
                            Command="{Binding NavigateCommand}" CommandParameter="About"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- ═══════════════════════════════════════════════════════════
             MAIN CONTENT AREA
             ═══════════════════════════════════════════════════════════ -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <!-- Header -->
                <RowDefinition Height="Auto"/>
                <!-- Content panels -->
                <RowDefinition Height="*"/>
                <!-- Log panel -->
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header Bar -->
            <Border Grid.Row="0" Background="{StaticResource BgCard}"
                    BorderBrush="{StaticResource Border}" BorderThickness="0,0,0,1"
                    Padding="16,10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="{Binding PageTitle}"
                               FontSize="18" FontWeight="SemiBold"
                               Foreground="{StaticResource Text1}"
                               VerticalAlignment="Center"/>

                    <!-- Connection Status Indicator -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal"
                                VerticalAlignment="Center">
                        <Ellipse Width="8" Height="8"
                                 Fill="{Binding ConnectionDotColor}"
                                 Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding ConnectionStatusText}"
                                   Foreground="{StaticResource Text2}" FontSize="12"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ═══════════════════════════════════════════════════════
                 CONTENT PANELS (visibility bound to CurrentPanel)
                 ═══════════════════════════════════════════════════════ -->
            <Grid Grid.Row="1">

                <!-- Dashboard Panel -->
                <Border x:Name="DashboardPanel"
                        Visibility="{Binding IsDashboardVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>

                            <!-- Status Cards -->
                            <UniformGrid Rows="1" Columns="4" Margin="0,0,0,16">

                                <!-- Services Card -->
                                <Border Background="{StaticResource BgCard}" CornerRadius="6"
                                        Margin="0,0,8,0">
                                    <StackPanel>
                                        <Border Background="{Binding ServicesBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="SERVICES" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding ServicesValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding ServicesSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Database Card -->
                                <Border Background="{StaticResource BgCard}" CornerRadius="6"
                                        Margin="4,0,4,0">
                                    <StackPanel>
                                        <Border Background="{Binding DatabaseBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="DATABASE" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding DatabaseValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding DatabaseSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Disk Card -->
                                <Border Background="{StaticResource BgCard}" CornerRadius="6"
                                        Margin="4,0,4,0">
                                    <StackPanel>
                                        <Border Background="{Binding DiskBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="DISK SPACE" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding DiskValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding DiskSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Task Card -->
                                <Border Background="{StaticResource BgCard}" CornerRadius="6"
                                        Margin="8,0,0,0">
                                    <StackPanel>
                                        <Border Background="{Binding TaskBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="SCHEDULED TASK" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding TaskValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding TaskSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                            </UniformGrid>

                            <!-- Quick Actions -->
                            <Border Background="{StaticResource BgCard}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,16">
                                <StackPanel>
                                    <TextBlock Text="Quick Actions" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{StaticResource Text1}" Margin="0,0,0,12"/>
                                    <WrapPanel>
                                        <Button Content="Diagnostics" Style="{StaticResource QuickActionBtn}"
                                                x:Name="QBtnDiagnostics" Margin="0,0,8,8"
                                                Command="{Binding QuickDiagnosticsCommand}"/>
                                        <Button Content="Deep Cleanup" Style="{StaticResource QuickActionBtn}"
                                                x:Name="QBtnCleanup" Margin="0,0,8,8"
                                                Command="{Binding QuickCleanupCommand}"/>
                                        <Button Content="Online Sync" Style="{StaticResource QuickActionBtn}"
                                                x:Name="QBtnSync" Margin="0,0,8,8"
                                                Command="{Binding QuickSyncCommand}"
                                                IsEnabled="{Binding IsOnline}"/>
                                        <Button Content="Start Services" Style="{StaticResource QuickActionBtn}"
                                                x:Name="QBtnStartServices" Margin="0,0,8,8"
                                                Command="{Binding QuickStartServicesCommand}"/>
                                    </WrapPanel>
                                </StackPanel>
                            </Border>

                            <!-- Configuration Info -->
                            <Border Background="{StaticResource BgCard}" CornerRadius="6"
                                    Padding="16">
                                <StackPanel>
                                    <TextBlock Text="Configuration" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{StaticResource Text1}" Margin="0,0,0,12"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Content Path"
                                                   Foreground="{StaticResource Text2}" FontSize="12" Margin="0,0,0,6"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ConfigContentPath}"
                                                   Foreground="{StaticResource Text1}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="SQL Instance"
                                                   Foreground="{StaticResource Text2}" FontSize="12" Margin="0,0,0,6"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ConfigSqlInstance}"
                                                   Foreground="{StaticResource Text1}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Log Path"
                                                   Foreground="{StaticResource Text2}" FontSize="12" Margin="0,0,0,6"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ConfigLogPath}"
                                                   Foreground="{StaticResource Text1}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Server Mode"
                                                   Foreground="{StaticResource Text2}" FontSize="12"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding ServerModeText}"
                                                   Foreground="{StaticResource Text1}" FontSize="12"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Operation Panel (placeholder for Phase 3+) -->
                <Border x:Name="OperationPanel"
                        Visibility="{Binding IsOperationPanelVisible}">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="{Binding PageTitle}" FontSize="20"
                                   Foreground="{StaticResource Text2}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="This operation will be available in a future update."
                                   Foreground="{StaticResource Text3}" FontSize="13"
                                   Margin="0,8,0,0" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

            </Grid>

            <!-- ═══════════════════════════════════════════════════════
                 LOG PANEL
                 ═══════════════════════════════════════════════════════ -->
            <Border Grid.Row="2" Background="{StaticResource BgCard}"
                    BorderBrush="{StaticResource Border}" BorderThickness="0,1,0,0">
                <DockPanel>
                    <!-- Log Header -->
                    <Border DockPanel.Dock="Top" Background="{StaticResource BgSidebar}"
                            Padding="12,6">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Orientation="Horizontal"
                                        VerticalAlignment="Center">
                                <TextBlock Text="Output Log" FontSize="12" FontWeight="SemiBold"
                                           Foreground="{StaticResource Text1}" Margin="0,0,12,0"/>
                                <TextBlock Text="{Binding CurrentOperationName}"
                                           FontSize="11" Foreground="{StaticResource Text2}"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="Cancel" Style="{StaticResource BtnRed}"
                                        Padding="10,4" FontSize="11" Margin="0,0,8,0"
                                        Command="{Binding CancelOperationCommand}"
                                        Visibility="{Binding CancelButtonVisibility}"/>
                                <Button Content="{Binding LogToggleText}" Style="{StaticResource BtnSec}"
                                        Padding="10,4" FontSize="11" Margin="0,0,4,0"
                                        Command="{Binding ToggleLogPanelCommand}"/>
                                <Button Content="Clear" Style="{StaticResource BtnSec}"
                                        Padding="10,4" FontSize="11" Margin="0,0,4,0"
                                        Command="{Binding ClearLogCommand}"/>
                                <Button Content="Save" Style="{StaticResource BtnSec}"
                                        Padding="10,4" FontSize="11"
                                        Command="{Binding SaveLogCommand}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Log Text Area -->
                    <TextBox DockPanel.Dock="Bottom"
                             Style="{StaticResource LogTextBox}"
                             Text="{Binding LogOutput, Mode=OneWay}"
                             Height="{Binding LogPanelHeight}"
                             Visibility="{Binding LogTextVisibility}"
                             x:Name="LogTextBox"
                             TextChanged="LogTextBox_TextChanged"/>
                </DockPanel>
            </Border>

            <!-- Status Bar -->
            <Border Grid.Row="2" VerticalAlignment="Bottom"
                    Background="{StaticResource BgSidebar}"
                    Padding="12,4" Visibility="Collapsed">
                <TextBlock Text="{Binding StatusMessage}"
                           Foreground="{StaticResource Text2}" FontSize="11"/>
            </Border>

        </Grid>
    </Grid>
</Window>
