<Window x:Class="WsusManager.App.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:automation="clr-namespace:System.Windows.Automation;assembly=PresentationCore"
        Title="WSUS Manager"
        Width="950" Height="780"
        MinWidth="800" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="{DynamicResource PrimaryBackground}"
        automation:AutomationProperties.AutomationId="MainWindow">

    <Window.InputBindings>
        <KeyBinding Key="F1" Command="{Binding ShowHelpCommand}"/>
        <KeyBinding Key="F5" Command="{Binding RefreshDashboardFromShortcutCommand}"/>
        <KeyBinding Key="S" Modifiers="Control" Command="{Binding OpenSettingsFromShortcutCommand}"/>
        <KeyBinding Key="Q" Modifiers="Control" Command="{Binding QuitCommand}"/>
        <KeyBinding Key="Escape" Command="{Binding CancelOperationFromShortcutCommand}"/>
    </Window.InputBindings>

    <Grid KeyboardNavigation.TabNavigation="Once">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="180"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SIDEBAR
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Column="0" Background="{DynamicResource NavBackground}"
                BorderBrush="{DynamicResource BorderPrimary}" BorderThickness="0,0,1,0">
            <DockPanel LastChildFill="False" KeyboardNavigation.TabNavigation="Continue">

                <!-- Branding -->
                <StackPanel DockPanel.Dock="Top" Margin="15,16,15,8">
                    <TextBlock Text="WSUS Manager" FontSize="16" FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimary}"/>
                    <TextBlock Text="{Binding VersionText}" FontSize="11"
                               Foreground="{DynamicResource TextMuted}" Margin="0,2,0,0"/>
                </StackPanel>

                <Separator DockPanel.Dock="Top" Background="{DynamicResource BorderPrimary}" Margin="15,4"/>

                <!-- SETUP Category -->
                <TextBlock DockPanel.Dock="Top" Text="SETUP" Style="{StaticResource CategoryLabel}"/>
                <Button DockPanel.Dock="Top" ToolTip="Install WSUS with SQL Server Express"
                        Style="{StaticResource NavBtn}" x:Name="BtnInstall"
                        automation:AutomationProperties.AutomationId="InstallButton"
                        Command="{Binding RunInstallWsusCommand}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="â¬‡" Width="22" TextAlignment="Center" Foreground="{DynamicResource TextSecondary}"/>
                        <TextBlock Text="Install WSUS"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="Copy GPO templates for domain deployment"
                        Style="{StaticResource NavBtn}" x:Name="BtnGpo"
                        automation:AutomationProperties.AutomationId="CreateGpoButton"
                        Command="{Binding RunCreateGpoCommand}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“‹" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Create GPO"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="Configure WSUS HTTPS on port 8531"
                        Style="{StaticResource NavBtn}" x:Name="BtnSetHttps"
                        automation:AutomationProperties.AutomationId="SetHttpsButton"
                        Command="{Binding RunSetHttpsCommand}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ”’" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Set HTTPS"/>
                    </StackPanel>
                </Button>

                <!-- OPERATIONS Category -->
                <TextBlock DockPanel.Dock="Top" Text="OPERATIONS" Style="{StaticResource CategoryLabel}"/>
                <Button DockPanel.Dock="Top" ToolTip="Synchronize with Microsoft Update servers"
                        Style="{StaticResource NavBtn}" x:Name="BtnSync"
                        automation:AutomationProperties.AutomationId="OnlineSyncButton"
                        Command="{Binding RunOnlineSyncCommand}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ”„" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Online Sync"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="Export metadata to USB or import from external media"
                        Style="{StaticResource NavBtn}" x:Name="BtnTransfer"
                        automation:AutomationProperties.AutomationId="TransferButton"
                        Command="{Binding RunTransferCommand}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“¤" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Export / Import"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="Create scheduled task for automated operations"
                        Style="{StaticResource NavBtn}" x:Name="BtnSchedule"
                        automation:AutomationProperties.AutomationId="ScheduleTaskButton"
                        Command="{Binding RunScheduleTaskCommand}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“…" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Schedule Task"/>
                    </StackPanel>
                </Button>

                <!-- TOOLS Category -->
                <TextBlock DockPanel.Dock="Top" Text="TOOLS" Style="{StaticResource CategoryLabel}"/>
                <Button DockPanel.Dock="Top" ToolTip="Run health checks and auto-repair"
                        x:Name="BtnDiagnostics"
                        automation:AutomationProperties.AutomationId="DiagnosticsButton"
                        Command="{Binding NavigateCommand}" CommandParameter="Diagnostics">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource NavBtn}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding CurrentPanel}" Value="Diagnostics">
                                    <Setter Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                                    <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                    <Setter Property="BorderThickness" Value="3,0,0,0"/>
                                    <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ”" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Diagnostics"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="Backup, restore, and cleanup operations"
                        x:Name="BtnDatabase"
                        automation:AutomationProperties.AutomationId="DatabaseButton"
                        Command="{Binding NavigateCommand}" CommandParameter="Database">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource NavBtn}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding CurrentPanel}" Value="Database">
                                    <Setter Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                                    <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                    <Setter Property="BorderThickness" Value="3,0,0,0"/>
                                    <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ—„" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Database"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="Remote client management and diagnostics"
                        x:Name="BtnClientTools"
                        automation:AutomationProperties.AutomationId="ClientToolsButton"
                        Command="{Binding NavigateCommand}" CommandParameter="ClientTools">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource NavBtn}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding CurrentPanel}" Value="ClientTools">
                                    <Setter Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                                    <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                    <Setter Property="BorderThickness" Value="3,0,0,0"/>
                                    <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ’»" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Client Tools"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="View and filter WSUS client computer status"
                        x:Name="BtnComputers"
                        automation:AutomationProperties.AutomationId="ComputersButton"
                        Command="{Binding NavigateCommand}" CommandParameter="Computers">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource NavBtn}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding CurrentPanel}" Value="Computers">
                                    <Setter Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                                    <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                    <Setter Property="BorderThickness" Value="3,0,0,0"/>
                                    <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ–¥" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Computers"/>
                    </StackPanel>
                </Button>
                <Button DockPanel.Dock="Top" ToolTip="View and filter WSUS update approvals"
                        x:Name="BtnUpdates"
                        automation:AutomationProperties.AutomationId="UpdatesButton"
                        Command="{Binding NavigateCommand}" CommandParameter="Updates">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource NavBtn}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding CurrentPanel}" Value="Updates">
                                    <Setter Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                                    <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                    <Setter Property="BorderThickness" Value="3,0,0,0"/>
                                    <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“¦" Width="22" TextAlignment="Center"/>
                        <TextBlock Text="Updates"/>
                    </StackPanel>
                </Button>

                <!-- Bottom utility buttons -->
                <StackPanel DockPanel.Dock="Bottom" Margin="0,0,0,8">
                    <Separator Background="{DynamicResource BorderPrimary}" Margin="15,4"/>
                    <Button Command="{Binding NavigateCommand}" CommandParameter="Dashboard"
                            automation:AutomationProperties.AutomationId="DashboardButton">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource NavBtn}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding CurrentPanel}" Value="Dashboard">
                                        <Setter Property="Background" Value="{DynamicResource NavActiveBackground}"/>
                                        <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                        <Setter Property="BorderThickness" Value="3,0,0,0"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ“Š" Width="22" TextAlignment="Center"/>
                            <TextBlock Text="Dashboard"/>
                        </StackPanel>
                    </Button>
                    <Button automation:AutomationProperties.AutomationId="SettingsButton"
                            Style="{StaticResource NavBtn}"
                            Command="{Binding NavigateCommand}" CommandParameter="Settings">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="âš™" Width="22" TextAlignment="Center" Foreground="{DynamicResource TextSecondary}"/>
                            <TextBlock Text="Settings"/>
                        </StackPanel>
                    </Button>
                    <Button automation:AutomationProperties.AutomationId="HelpButton"
                            Style="{StaticResource NavBtn}"
                            Command="{Binding NavigateCommand}" CommandParameter="Help">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="â“" Width="22" TextAlignment="Center"/>
                            <TextBlock Text="Help"/>
                        </StackPanel>
                    </Button>
                    <Button automation:AutomationProperties.AutomationId="AboutButton"
                            Style="{StaticResource NavBtn}"
                            Command="{Binding NavigateCommand}" CommandParameter="About">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="â„¹" Width="22" TextAlignment="Center" Foreground="{DynamicResource TextSecondary}"/>
                            <TextBlock Text="About"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             MAIN CONTENT AREA
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Grid Grid.Column="1" KeyboardNavigation.TabNavigation="Continue">
            <Grid.RowDefinitions>
                <!-- Header -->
                <RowDefinition Height="Auto"/>
                <!-- Content panels -->
                <RowDefinition Height="*"/>
                <!-- Log panel -->
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header Bar -->
            <Border Grid.Row="0" Background="{DynamicResource CardBackground}"
                    BorderBrush="{DynamicResource BorderPrimary}" BorderThickness="0,0,0,1"
                    Padding="16,10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="{Binding PageTitle}"
                               FontSize="18" FontWeight="SemiBold"
                               Foreground="{DynamicResource TextPrimary}"
                               VerticalAlignment="Center"/>

                    <!-- Connection Status Indicator -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal"
                                VerticalAlignment="Center">
                        <!-- Loading spinner removed: log panel progress bar is sufficient -->
                        <Ellipse Width="8" Height="8"
                                 Fill="{Binding ConnectionDotColor}"
                                 Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding ConnectionStatusText}"
                                   Foreground="{DynamicResource TextSecondary}" FontSize="12"/>
                        <TextBlock Text="{Binding ModeOverrideIndicator}"
                                   Foreground="{DynamicResource TextMuted}" FontSize="11"
                                   Margin="4,0,0,0"
                                   VerticalAlignment="Center"/>
                        <!-- Estimated Time Remaining (Phase 27) -->
                        <TextBlock Text="{Binding EstimatedTimeRemaining}"
                                   Foreground="{DynamicResource TextMuted}" FontSize="11"
                                   Margin="12,0,0,0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 CONTENT PANELS (visibility bound to CurrentPanel)
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid Grid.Row="1" KeyboardNavigation.TabNavigation="Once">

                <!-- Dashboard Panel -->
                <Border x:Name="DashboardPanel"
                        automation:AutomationProperties.AutomationId="DashboardPanel"
                        Visibility="{Binding IsDashboardVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>

                            <!-- Status Cards -->
                            <UniformGrid Rows="1" Columns="4" Margin="0,0,0,16">

                                <!-- Services Card -->
                                <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                        Margin="0,0,8,0">
                                    <StackPanel>
                                        <Border Background="{Binding ServicesBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="SERVICES" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding ServicesValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding ServicesSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Database Card -->
                                <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                        Margin="4,0,4,0">
                                    <StackPanel>
                                        <Border Background="{Binding DatabaseBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="DATABASE" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding DatabaseValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding DatabaseSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Disk Card -->
                                <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                        Margin="4,0,4,0">
                                    <StackPanel>
                                        <Border Background="{Binding DiskBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="DISK SPACE" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding DiskValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding DiskSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Task Card -->
                                <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                        Margin="8,0,0,0">
                                    <StackPanel>
                                        <Border Background="{Binding TaskBarColor}"
                                                CornerRadius="6,6,0,0" Height="4"/>
                                        <StackPanel Margin="16,12,16,16">
                                            <TextBlock Text="SCHEDULED TASK" Style="{StaticResource CardTitle}"/>
                                            <TextBlock Text="{Binding TaskValue}"
                                                       Style="{StaticResource CardValue}" Margin="0,4,0,0"/>
                                            <TextBlock Text="{Binding TaskSubtext}"
                                                       Style="{StaticResource CardSubtext}" Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                            </UniformGrid>

                            <!-- Quick Actions -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,16">
                                <StackPanel>
                                    <TextBlock Text="Quick Actions" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                                    <WrapPanel>
                                        <Button Content="Diagnostics" Style="{StaticResource QuickActionBtn}"
                                                ToolTip="Run health checks and auto-repair"
                                                x:Name="QBtnDiagnostics" Margin="0,0,8,8"
                                                automation:AutomationProperties.AutomationId="QuickDiagnosticsButton"
                                                Command="{Binding QuickDiagnosticsCommand}"/>
                                        <Button Content="Deep Cleanup" Style="{StaticResource QuickActionBtn}"
                                                ToolTip="Remove obsolete updates and optimize database"
                                                x:Name="QBtnCleanup" Margin="0,0,8,8"
                                                automation:AutomationProperties.AutomationId="QuickCleanupButton"
                                                Command="{Binding QuickCleanupCommand}"/>
                                        <Button Content="Online Sync" Style="{StaticResource QuickActionBtn}"
                                                ToolTip="Synchronize with Microsoft Update servers"
                                                x:Name="QBtnSync" Margin="0,0,8,8"
                                                automation:AutomationProperties.AutomationId="QuickSyncButton"
                                                Command="{Binding QuickSyncCommand}"
                                                IsEnabled="{Binding IsOnline}"/>
                                        <Button Content="Start Services" Style="{StaticResource QuickActionBtn}"
                                                ToolTip="Start SQL, WSUS, and IIS services"
                                                x:Name="QBtnStartServices" Margin="0,0,8,8"
                                                automation:AutomationProperties.AutomationId="QuickStartServicesButton"
                                                Command="{Binding QuickStartServicesCommand}"/>
                                        <Button x:Name="QBtnToggleMode"
                                                automation:AutomationProperties.AutomationId="ToggleModeButton"
                                                Style="{StaticResource QuickActionBtn}"
                                                Content="{Binding ToggleModeText}"
                                                Margin="0,0,8,8"
                                                Command="{Binding ToggleModeCommand}"
                                                ToolTip="Manually override Online/Air-Gap mode. Bypasses automatic network detection."/>
                                    </WrapPanel>
                                </StackPanel>
                            </Border>

                            <!-- Configuration Info -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16">
                                <StackPanel>
                                    <TextBlock Text="Configuration" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Content Path"
                                                   Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,6"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ConfigContentPath}"
                                                   Foreground="{DynamicResource TextPrimary}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="SQL Instance"
                                                   Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,6"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ConfigSqlInstance}"
                                                   Foreground="{DynamicResource TextPrimary}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Log Path"
                                                   Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,6"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ConfigLogPath}"
                                                   Foreground="{DynamicResource TextPrimary}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Server Mode"
                                                   Foreground="{DynamicResource TextSecondary}" FontSize="12"/>
                                        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                            <TextBlock Text="{Binding ServerModeText}"
                                                       Foreground="{DynamicResource TextPrimary}" FontSize="12"/>
                                            <TextBlock Text="{Binding ModeOverrideIndicator}"
                                                       Foreground="{DynamicResource TextMuted}" FontSize="11"
                                                       Margin="6,0,0,0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Diagnostics Panel -->
                <Border x:Name="DiagnosticsPanel"
                        automation:AutomationProperties.AutomationId="DiagnosticsPanel"
                        Visibility="{Binding IsDiagnosticsPanelVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>

                            <!-- Primary Actions -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Diagnostics" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                                    <TextBlock Text="Run a comprehensive health check of all WSUS components. Failed checks are automatically repaired where possible."
                                               Foreground="{DynamicResource TextSecondary}" FontSize="12"
                                               TextWrapping="Wrap" Margin="0,0,0,12"/>
                                    <WrapPanel>
                                        <Button Content="Run Diagnostics" Style="{StaticResource BtnGreen}"
                                                automation:AutomationProperties.AutomationId="HealthCheckButton"
                                                Padding="16,8" Margin="0,0,8,0"
                                                Command="{Binding RunDiagnosticsCommand}"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                        <Button Content="Reset Content" Style="{StaticResource BtnSec}"
                                                automation:AutomationProperties.AutomationId="ResetContentButton"
                                                Padding="16,8" ToolTip="Runs wsusutil reset to re-verify content files (use after air-gap import)"
                                                Command="{Binding ResetContentCommand}"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                    </WrapPanel>
                                </StackPanel>
                            </Border>

                            <!-- Service Control -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16">
                                <StackPanel>
                                    <TextBlock Text="Service Control" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                                    <TextBlock Text="Start or stop individual WSUS services. Services are managed in dependency order."
                                               Foreground="{DynamicResource TextSecondary}" FontSize="12"
                                               TextWrapping="Wrap" Margin="0,0,0,12"/>

                                    <!-- SQL Server Row -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                            <TextBlock Text="SQL Server Express" FontSize="13"
                                                       Foreground="{DynamicResource TextPrimary}"/>
                                            <TextBlock Text="MSSQL$SQLEXPRESS" FontSize="11"
                                                       Foreground="{DynamicResource TextMuted}"/>
                                        </StackPanel>
                                        <Button Grid.Column="1" Content="Start" Style="{StaticResource BtnGreen}"
                                                Padding="12,4" Margin="0,0,6,0"
                                                Command="{Binding StartServiceCommand}"
                                                CommandParameter="MSSQL$SQLEXPRESS"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                        <Button Grid.Column="2" Content="Stop" Style="{StaticResource BtnRed}"
                                                Padding="12,4"
                                                Command="{Binding StopServiceCommand}"
                                                CommandParameter="MSSQL$SQLEXPRESS"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                    </Grid>

                                    <Separator Background="{DynamicResource BorderPrimary}" Margin="0,4"/>

                                    <!-- IIS Row -->
                                    <Grid Margin="0,8,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                            <TextBlock Text="IIS (World Wide Web)" FontSize="13"
                                                       Foreground="{DynamicResource TextPrimary}"/>
                                            <TextBlock Text="W3SVC" FontSize="11"
                                                       Foreground="{DynamicResource TextMuted}"/>
                                        </StackPanel>
                                        <Button Grid.Column="1" Content="Start" Style="{StaticResource BtnGreen}"
                                                Padding="12,4" Margin="0,0,6,0"
                                                Command="{Binding StartServiceCommand}"
                                                CommandParameter="W3SVC"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                        <Button Grid.Column="2" Content="Stop" Style="{StaticResource BtnRed}"
                                                Padding="12,4"
                                                Command="{Binding StopServiceCommand}"
                                                CommandParameter="W3SVC"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                    </Grid>

                                    <Separator Background="{DynamicResource BorderPrimary}" Margin="0,4"/>

                                    <!-- WSUS Row -->
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                            <TextBlock Text="WSUS Service" FontSize="13"
                                                       Foreground="{DynamicResource TextPrimary}"/>
                                            <TextBlock Text="WsusService" FontSize="11"
                                                       Foreground="{DynamicResource TextMuted}"/>
                                        </StackPanel>
                                        <Button Grid.Column="1" Content="Start" Style="{StaticResource BtnGreen}"
                                                Padding="12,4" Margin="0,0,6,0"
                                                Command="{Binding StartServiceCommand}"
                                                CommandParameter="WsusService"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                        <Button Grid.Column="2" Content="Stop" Style="{StaticResource BtnRed}"
                                                Padding="12,4"
                                                Command="{Binding StopServiceCommand}"
                                                CommandParameter="WsusService"
                                                IsEnabled="{Binding IsWsusInstalled}"/>
                                    </Grid>

                                </StackPanel>
                            </Border>

                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Database Operations Panel -->
                <Border x:Name="DatabasePanel"
                        automation:AutomationProperties.AutomationId="DatabasePanel"
                        Visibility="{Binding IsDatabasePanelVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>

                            <!-- DB Size Info -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Database Size" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,6"/>
                                    <TextBlock Text="{Binding DatabaseValue}"
                                               FontSize="22" FontWeight="Bold"
                                               Foreground="{DynamicResource TextPrimary}"/>
                                    <TextBlock Text="{Binding DatabaseSubtext}"
                                               Foreground="{DynamicResource TextSecondary}" FontSize="12"
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>

                            <!-- Deep Cleanup -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Deep Cleanup" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12"
                                               Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,12"
                                               Text="Runs the full 6-step cleanup pipeline: WSUS built-in cleanup, remove supersession records, delete declined updates, rebuild indexes, and shrink the database."/>
                                    <Button Content="Run Deep Cleanup" Style="{StaticResource BtnGreen}"
                                            automation:AutomationProperties.AutomationId="DeepCleanupButton"
                                            Padding="16,8" HorizontalAlignment="Left"
                                            Command="{Binding RunDeepCleanupCommand}"
                                            IsEnabled="{Binding IsWsusInstalled}"/>
                                </StackPanel>
                            </Border>

                            <!-- Backup Database -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Backup Database" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12"
                                               Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,12"
                                               Text="Creates a compressed SQL backup of SUSDB. You will be prompted to choose a destination file. Requires SQL sysadmin permissions."/>
                                    <Button Content="Backup Database" Style="{StaticResource BtnSec}"
                                            automation:AutomationProperties.AutomationId="BackupButton"
                                            Padding="16,8" HorizontalAlignment="Left"
                                            Command="{Binding BackupDatabaseCommand}"
                                            IsEnabled="{Binding IsWsusInstalled}"/>
                                </StackPanel>
                            </Border>

                            <!-- Restore Database -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16">
                                <StackPanel>
                                    <TextBlock Text="Restore Database" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12"
                                               Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,4"
                                               Text="Restores SUSDB from a backup file. WSUS and IIS services will be stopped during restore."/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,12"
                                               Text="WARNING: This replaces all current WSUS data."/>
                                    <Button Content="Restore Database" Style="{StaticResource BtnSec}"
                                            automation:AutomationProperties.AutomationId="RestoreButton"
                                            Padding="16,8" HorizontalAlignment="Left"
                                            Command="{Binding RestoreDatabaseCommand}"
                                            IsEnabled="{Binding IsWsusInstalled}"/>
                                </StackPanel>
                            </Border>

                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Client Tools Panel -->
                <Border x:Name="ClientToolsPanel"
                        automation:AutomationProperties.AutomationId="ClientToolsPanel"
                        Visibility="{Binding IsClientToolsPanelVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>

                            <!-- Target Host -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Target Host" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock Text="Enter the hostname of the client machine to manage. Operations use WinRM (Windows Remote Management)."
                                               Foreground="{DynamicResource TextSecondary}" FontSize="12"
                                               TextWrapping="Wrap" Margin="0,0,0,12"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Hostname:"
                                                   Foreground="{DynamicResource TextSecondary}" FontSize="13"
                                                   VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1"
                                                 Text="{Binding ClientHostname, UpdateSourceTrigger=PropertyChanged}"
                                                 Background="{DynamicResource InputBackground}"
                                                 Foreground="{DynamicResource TextPrimary}"
                                                 BorderBrush="{DynamicResource BorderPrimary}"
                                                 Padding="8,6" FontSize="13"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Remote Operations -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Remote Operations" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                                    <WrapPanel>
                                        <Button Content="Cancel Stuck Jobs" Style="{StaticResource BtnSec}"
                                                automation:AutomationProperties.AutomationId="CancelStuckJobsButton"
                                                Padding="16,8" Margin="0,0,8,8"
                                                Command="{Binding RunClientCancelStuckJobsCommand}"
                                                ToolTip="Stop WU services, clear cache, restart â€” fixes stuck update jobs"/>
                                        <Button Content="Force Check-In" Style="{StaticResource BtnSec}"
                                                automation:AutomationProperties.AutomationId="RemoteGpUpdateButton"
                                                Padding="16,8" Margin="0,0,8,8"
                                                Command="{Binding RunClientForceCheckInCommand}"
                                                ToolTip="Run gpupdate, resetauthorization, detectnow, reportnow"/>
                                        <Button Content="Test Connectivity" Style="{StaticResource BtnSec}"
                                                automation:AutomationProperties.AutomationId="TestConnectivityButton"
                                                Padding="16,8" Margin="0,0,8,8"
                                                Command="{Binding RunClientTestConnectivityCommand}"
                                                ToolTip="Test TCP connection from client to WSUS server on ports 8530/8531"/>
                                        <Button Content="Run Diagnostics" Style="{StaticResource BtnGreen}"
                                                automation:AutomationProperties.AutomationId="ClientDiagnosticsButton"
                                                Padding="16,8" Margin="0,0,8,8"
                                                Command="{Binding RunClientDiagnosticsCommand}"
                                                ToolTip="Gather WSUS settings, service status, last check-in, reboot state"/>
                                    </WrapPanel>
                                </StackPanel>
                            </Border>

                            <!-- Mass Operations -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Mass Operations" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock Text="Enter hostnames (one per line, or comma-separated) or load from a text file. Mass GPUpdate runs gpupdate + WSUS check-in on every host."
                                               Foreground="{DynamicResource TextSecondary}" FontSize="12"
                                               TextWrapping="Wrap" Margin="0,0,0,12"/>
                                    <TextBox 
                                             automation:AutomationProperties.AutomationId="MassHostnamesTextBox"
                                             Text="{Binding MassHostnames, UpdateSourceTrigger=PropertyChanged}"
                                             Background="{DynamicResource InputBackground}"
                                             Foreground="{DynamicResource TextPrimary}"
                                             BorderBrush="{DynamicResource BorderPrimary}"
                                             Padding="8,6" FontSize="12" FontFamily="Consolas"
                                             AcceptsReturn="True" TextWrapping="Wrap"
                                             MinHeight="80" MaxHeight="150"
                                             VerticalScrollBarVisibility="Auto"/>
                                    <WrapPanel Margin="0,8,0,0">
                                        <Button Content="Load from File" Style="{StaticResource BtnSec}"
                                                automation:AutomationProperties.AutomationId="LoadFromFileButton"
                                                Padding="16,8" Margin="0,0,8,0"
                                                Command="{Binding LoadHostFileCommand}"
                                                ToolTip="Load hostnames from a text file (one per line)"/>
                                        <Button Content="Mass GPUpdate" Style="{StaticResource BtnGreen}"
                                                automation:AutomationProperties.AutomationId="MassGpUpdateButton"
                                                Padding="16,8" Margin="0,0,8,0"
                                                Command="{Binding RunMassGpUpdateCommand}"
                                                ToolTip="Run gpupdate + WSUS check-in on all listed hosts"/>
                                    </WrapPanel>
                                </StackPanel>
                            </Border>

                            <!-- Script Generator -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Script Generator" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock Text="Generate a ready-to-run PowerShell script for environments where WinRM is unavailable. Copy the script to the target host and run it as Administrator."
                                               Foreground="{DynamicResource TextSecondary}" FontSize="12"
                                               TextWrapping="Wrap" Margin="0,0,0,12"/>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="90"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Operation:"
                                                   Foreground="{DynamicResource TextSecondary}" FontSize="13"
                                                   VerticalAlignment="Center"/>
                                        <ComboBox Grid.Column="1"
                                                  
                                                  automation:AutomationProperties.AutomationId="ScriptOperationComboBox"
                                                  ItemsSource="{Binding ScriptOperations}"
                                                  SelectedItem="{Binding SelectedScriptOperation}"
                                                  Background="{DynamicResource InputBackground}"
                                                  Foreground="{DynamicResource TextPrimary}"
                                                  BorderBrush="{DynamicResource BorderPrimary}"
                                                  Padding="8,6" FontSize="13"/>
                                    </Grid>
                                    <Button Content="Generate Script" Style="{StaticResource BtnSec}"
                                            automation:AutomationProperties.AutomationId="GenerateScriptButton"
                                            Padding="16,8" HorizontalAlignment="Left"
                                            Command="{Binding GenerateScriptCommand}"
                                            ToolTip="Generate a PowerShell script file for the selected operation"/>
                                </StackPanel>
                            </Border>

                            <!-- Error Code Lookup -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16">
                                <StackPanel>
                                    <TextBlock Text="Error Code Lookup" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock Text="Enter a WSUS or Windows Update error code (e.g., 0x80072EE2) to see its description and recommended fix."
                                               Foreground="{DynamicResource TextSecondary}" FontSize="12"
                                               TextWrapping="Wrap" Margin="0,0,0,12"/>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="90"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Error Code:"
                                                   Foreground="{DynamicResource TextSecondary}" FontSize="13"
                                                   VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1"
                                                 
                                                 automation:AutomationProperties.AutomationId="ErrorCodeInputTextBox"
                                                 Text="{Binding ErrorCodeInput, UpdateSourceTrigger=PropertyChanged}"
                                                 Background="{DynamicResource InputBackground}"
                                                 Foreground="{DynamicResource TextPrimary}"
                                                 BorderBrush="{DynamicResource BorderPrimary}"
                                                 Padding="8,6" FontSize="13"/>
                                        <Button Grid.Column="2" Content="Lookup" Style="{StaticResource BtnSec}"
                                                Padding="16,6" Margin="8,0,0,0"
                                                Command="{Binding LookupErrorCodeCommand}"/>
                                    </Grid>
                                    <TextBox 
                                             automation:AutomationProperties.AutomationId="ErrorCodeResultTextBox"
                                             Text="{Binding ErrorCodeResult, Mode=OneWay}"
                                             Background="{DynamicResource PrimaryBackground}"
                                             Foreground="{DynamicResource TextPrimary}"
                                             BorderThickness="0"
                                             FontFamily="Consolas" FontSize="12"
                                             IsReadOnly="True" TextWrapping="Wrap"
                                             Padding="8" MinHeight="60"/>
                                </StackPanel>
                            </Border>

                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Computers Panel (Phase 29) -->
                <Border x:Name="ComputersPanel"
                        automation:AutomationProperties.AutomationId="ComputersPanel"
                        Visibility="{Binding IsComputersPanelVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>

                            <!-- Filter Row -->
                            <StackPanel Style="{StaticResource FilterRow}">
                                <!-- Status Filter -->
                                <TextBlock Text="Status:"
                                           Foreground="{DynamicResource TextSecondary}"
                                           FontSize="12"
                                           VerticalAlignment="Center"
                                           Margin="0,0,6,0"/>
                                <ComboBox Style="{StaticResource FilterComboBox}"
                                          SelectedItem="{Binding ComputerStatusFilter}"
                                          Width="120">
                                    <ComboBoxItem Content="All"/>
                                    <ComboBoxItem Content="Online"/>
                                    <ComboBoxItem Content="Offline"/>
                                    <ComboBoxItem Content="Error"/>
                                </ComboBox>

                                <!-- Search Box -->
                                <TextBox Style="{StaticResource FilterSearchBox}"
                                         Text="{Binding ComputerSearchText, UpdateSourceTrigger=PropertyChanged}"
                                         automation:AutomationProperties.AutomationId="ComputerSearchTextBox"
                                         Margin="12,0,0,0">
                                    <TextBox.InputBindings>
                                        <KeyBinding Key="Escape" Command="{Binding ClearComputerFiltersCommand}"/>
                                    </TextBox.InputBindings>
                                </TextBox>

                                <!-- Clear Filters Button -->
                                <Button Content="Clear Filters"
                                        Style="{StaticResource ClearFiltersButton}"
                                        Command="{Binding ClearComputerFiltersCommand}"
                                        Visibility="{Binding ShowClearComputerFilters, Converter={StaticResource BoolToVisibilityConverter}}"
                                        automation:AutomationProperties.AutomationId="ClearComputerFiltersButton"/>

                                <!-- Export Button (Phase 30) -->
                                <Button Content="Export"
                                        Style="{StaticResource ClearFiltersButton}"
                                        Command="{Binding ExportComputersCommand}"
                                        Margin="12,0,0,0"
                                        automation:AutomationProperties.AutomationId="ExportComputersButton"/>
                            </StackPanel>

                            <!-- Filter Count Text -->
                            <TextBlock Text="{Binding ComputerFilterCountText}"
                                       Foreground="{DynamicResource TextMuted}"
                                       FontSize="11"
                                       Margin="0,0,0,12"/>

                            <!-- Computers ListBox (virtualized) -->
                            <Border Background="{DynamicResource InputBackground}"
                                    BorderBrush="{DynamicResource BorderPrimary}"
                                    BorderThickness="1"
                                    CornerRadius="4"
                                    MinHeight="300">
                                <ListBox x:Name="ComputersListBox"
                                         ItemsSource="{Binding FilteredComputers}"
                                         VirtualizingPanel.IsVirtualizing="True"
                                         VirtualizingPanel.VirtualizationMode="Recycling"
                                         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                         Background="Transparent"
                                         BorderThickness="0"
                                         automation:AutomationProperties.AutomationId="ComputersListBox">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Margin="8,6">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200"/>
                                                    <ColumnDefinition Width="120"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="140"/>
                                                    <ColumnDefinition Width="60"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="{Binding Hostname}"
                                                           Foreground="{DynamicResource TextPrimary}"
                                                           FontSize="12"/>
                                                <TextBlock Grid.Column="1" Text="{Binding IpAddress}"
                                                           Foreground="{DynamicResource TextSecondary}"
                                                           FontSize="12"/>
                                                <TextBlock Grid.Column="2" Text="{Binding Status}">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Status}" Value="Online">
                                                                    <Setter Property="Foreground" Value="{DynamicResource StatusSuccess}"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="Offline">
                                                                    <Setter Property="Foreground" Value="{DynamicResource StatusError}"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="Error">
                                                                    <Setter Property="Foreground" Value="{DynamicResource StatusWarning}"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <TextBlock Grid.Column="3" Text="{Binding LastSync, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}"
                                                           Foreground="{DynamicResource TextSecondary}"
                                                           FontSize="12"/>
                                                <TextBlock Grid.Column="4" Text="{Binding PendingUpdates, StringFormat='{}{0} pending'}"
                                                           Foreground="{DynamicResource TextSecondary}"
                                                           FontSize="12"/>
                                                <TextBlock Grid.Column="5" Text="{Binding OsVersion}"
                                                           Foreground="{DynamicResource TextMuted}"
                                                           FontSize="11"
                                                           TextTrimming="CharacterEllipsis"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>

                                    <!-- Empty State -->
                                    <ListBox.Style>
                                        <Style TargetType="ListBox">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding FilteredComputers.Count}" Value="0">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ListBox">
                                                                <TextBlock Text="No items match your current filters"
                                                                           Style="{StaticResource EmptyStateText}"/>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListBox.Style>
                                </ListBox>
                            </Border>

                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Updates Panel (Phase 29) -->
                <Border x:Name="UpdatesPanel"
                        automation:AutomationProperties.AutomationId="UpdatesPanel"
                        Visibility="{Binding IsUpdatesPanelVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>

                            <!-- Filter Row -->
                            <StackPanel Style="{StaticResource FilterRow}">
                                <!-- Approval Filter -->
                                <TextBlock Text="Approval:"
                                           Foreground="{DynamicResource TextSecondary}"
                                           FontSize="12"
                                           VerticalAlignment="Center"
                                           Margin="0,0,6,0"/>
                                <ComboBox Style="{StaticResource FilterComboBox}"
                                          SelectedItem="{Binding UpdateApprovalFilter}"
                                          Width="140">
                                    <ComboBoxItem Content="All"/>
                                    <ComboBoxItem Content="Approved"/>
                                    <ComboBoxItem Content="Not Approved"/>
                                    <ComboBoxItem Content="Declined"/>
                                </ComboBox>

                                <!-- Classification Filter -->
                                <TextBlock Text="Class:"
                                           Foreground="{DynamicResource TextSecondary}"
                                           FontSize="12"
                                           VerticalAlignment="Center"
                                           Margin="12,0,6,0"/>
                                <ComboBox Style="{StaticResource FilterComboBox}"
                                          SelectedItem="{Binding UpdateClassificationFilter}"
                                          Width="120">
                                    <ComboBoxItem Content="All"/>
                                    <ComboBoxItem Content="Critical"/>
                                    <ComboBoxItem Content="Security"/>
                                    <ComboBoxItem Content="Definition"/>
                                    <ComboBoxItem Content="Updates"/>
                                </ComboBox>

                                <!-- Search Box -->
                                <TextBox Style="{StaticResource FilterSearchBox}"
                                         Text="{Binding UpdateSearchText, UpdateSourceTrigger=PropertyChanged}"
                                         automation:AutomationProperties.AutomationId="UpdateSearchTextBox"
                                         Margin="12,0,0,0">
                                    <TextBox.InputBindings>
                                        <KeyBinding Key="Escape" Command="{Binding ClearUpdateFiltersCommand}"/>
                                    </TextBox.InputBindings>
                                </TextBox>

                                <!-- Clear Filters Button -->
                                <Button Content="Clear Filters"
                                        Style="{StaticResource ClearFiltersButton}"
                                        Command="{Binding ClearUpdateFiltersCommand}"
                                        Visibility="{Binding ShowClearUpdateFilters, Converter={StaticResource BoolToVisibilityConverter}}"
                                        automation:AutomationProperties.AutomationId="ClearUpdateFiltersButton"/>

                                <!-- Export Button (Phase 30) -->
                                <Button Content="Export"
                                        Style="{StaticResource ClearFiltersButton}"
                                        Command="{Binding ExportUpdatesCommand}"
                                        Margin="12,0,0,0"
                                        automation:AutomationProperties.AutomationId="ExportUpdatesButton"/>
                            </StackPanel>

                            <!-- Filter Count Text -->
                            <TextBlock Text="{Binding UpdateFilterCountText}"
                                       Foreground="{DynamicResource TextMuted}"
                                       FontSize="11"
                                       Margin="0,0,0,12"/>

                            <!-- Updates ListView (virtualized) -->
                            <Border Background="{DynamicResource InputBackground}"
                                    BorderBrush="{DynamicResource BorderPrimary}"
                                    BorderThickness="1"
                                    CornerRadius="4"
                                    MinHeight="300">
                                <ListView x:Name="UpdatesListView"
                                          ItemsSource="{Binding FilteredUpdates}"
                                          VirtualizingPanel.IsVirtualizing="True"
                                          VirtualizingPanel.VirtualizationMode="Recycling"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          automation:AutomationProperties.AutomationId="UpdatesListView">
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="KB Article" Width="100">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding KbArticle, StringFormat='{}KB{0}'}"
                                                                   Foreground="{DynamicResource TextPrimary}"
                                                                   FontSize="12"
                                                                   TextTrimming="CharacterEllipsis"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Title" Width="400">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Title}"
                                                                   Foreground="{DynamicResource TextPrimary}"
                                                                   FontSize="12"
                                                                   TextTrimming="CharacterEllipsis"
                                                                   ToolTip="{Binding Title}"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Classification" Width="120">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Classification}"
                                                                   Foreground="{DynamicResource TextSecondary}"
                                                                   FontSize="12"
                                                                   TextTrimming="CharacterEllipsis"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Status" Width="100">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock>
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="FontSize" Value="12"/>
                                                                    <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsApproved}" Value="True">
                                                                            <Setter Property="Foreground" Value="{DynamicResource StatusSuccess}"/>
                                                                            <Setter Property="Text" Value="Approved"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding IsDeclined}" Value="True">
                                                                            <Setter Property="Foreground" Value="{DynamicResource StatusError}"/>
                                                                            <Setter Property="Text" Value="Declined"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding IsApproved}" Value="False">
                                                                            <DataTrigger Binding="{Binding IsDeclined}" Value="False">
                                                                                <Setter Property="Text" Value="Not Approved"/>
                                                                            </DataTrigger>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Date" Width="100">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding ApprovalDate, StringFormat='{}{0:yyyy-MM-dd}'}"
                                                                   Foreground="{DynamicResource TextSecondary}"
                                                                   FontSize="12"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </ListView.View>

                                    <!-- Empty State -->
                                    <ListView.Style>
                                        <Style TargetType="ListView">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding FilteredUpdates.Count}" Value="0">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ListView">
                                                                <TextBlock Text="No items match your current filters"
                                                                           Style="{StaticResource EmptyStateText}"/>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListView.Style>
                                </ListView>
                            </Border>

                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Help Panel -->
                <Border x:Name="HelpPanel"
                        automation:AutomationProperties.AutomationId="HelpPanel"
                        Visibility="{Binding IsHelpPanelVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Help &amp; Documentation" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12"
                                               Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,12"
                                               Text="WSUS Manager is a comprehensive tool for managing Windows Server Update Services. Use the sidebar navigation to access different features."/>
                                </StackPanel>
                            </Border>

                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Keyboard Shortcuts" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="F1" Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,6" FontFamily="Consolas"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="Open Help" Foreground="{DynamicResource TextPrimary}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="F5" Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,6" FontFamily="Consolas"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="Refresh Dashboard" Foreground="{DynamicResource TextPrimary}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Ctrl+S" Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,6" FontFamily="Consolas"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="Open Settings" Foreground="{DynamicResource TextPrimary}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Ctrl+Q" Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,6" FontFamily="Consolas"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="Quit Application" Foreground="{DynamicResource TextPrimary}" FontSize="12" Margin="0,0,0,6"/>

                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Escape" Foreground="{DynamicResource TextSecondary}" FontSize="12" FontFamily="Consolas"/>
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="Cancel Operation" Foreground="{DynamicResource TextPrimary}" FontSize="12"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Quick Actions" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12"
                                               Foreground="{DynamicResource TextSecondary}"
                                               Text="â€¢ Diagnostics â€” Run health checks and auto-repair WSUS components&#x0a;â€¢ Deep Cleanup â€” Remove obsolete updates and optimize database&#x0a;â€¢ Online Sync â€” Synchronize with Microsoft Update (online mode only)&#x0a;â€¢ Start Services â€” Start SQL, WSUS, and IIS services&#x0a;â€¢ Toggle Mode â€” Switch between Online and Air-Gap modes"/>
                                </StackPanel>
                            </Border>

                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16">
                                <StackPanel>
                                    <TextBlock Text="Air-Gap Support" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12"
                                               Foreground="{DynamicResource TextSecondary}"
                                               Text="For air-gapped networks, use Export/Import to transfer WSUS metadata via USB. The app automatically detects network connectivity and adjusts available features."/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- About Panel -->
                <Border x:Name="AboutPanel"
                        automation:AutomationProperties.AutomationId="AboutPanel"
                        Visibility="{Binding IsAboutPanelVisible}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                        <StackPanel>
                            <!-- Branding Header -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel Orientation="Horizontal">
                                    <Image Width="56" Height="56" Margin="0,0,16,0" VerticalAlignment="Center"
                                           Source="general_atomics_logo_big.ico" Stretch="Uniform"/>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="WSUS Manager" FontSize="18" FontWeight="Bold"
                                                   Foreground="{DynamicResource TextPrimary}"/>
                                        <TextBlock Text="{Binding VersionText}" FontSize="12"
                                                   Foreground="{DynamicResource TextSecondary}" Margin="0,4,0,0"/>
                                        <TextBlock Text="Windows Server Update Services Management Tool"
                                                   FontSize="11" Foreground="{DynamicResource TextMuted}"
                                                   Margin="0,4,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- Author Info -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Author" FontSize="13" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock Text="Tony Tran" FontSize="13" FontWeight="SemiBold"
                                               Foreground="{DynamicResource AccentBrush}"/>
                                    <TextBlock Text="ISSO, Classified Computing, GA-ASI" FontSize="11"
                                               Foreground="{DynamicResource TextSecondary}" Margin="0,2,0,0"/>
                                    <TextBlock Text="tony.tran@ga-asi.com" FontSize="11"
                                               Foreground="{DynamicResource AccentBrush}" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Border>

                            <!-- Features -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Features" FontSize="13" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="11"
                                               Foreground="{DynamicResource TextSecondary}"
                                               Text="â€¢ Automated WSUS + SQL Express installation&#x0a;â€¢ Database backup/restore operations&#x0a;â€¢ Air-gapped network export/import&#x0a;â€¢ Monthly maintenance automation&#x0a;â€¢ Health diagnostics with auto-repair&#x0a;â€¢ Deep cleanup and optimization&#x0a;â€¢ Remote client management&#x0a;â€¢ CSV export for computers and updates"/>
                                </StackPanel>
                            </Border>

                            <!-- Requirements -->
                            <Border Background="{DynamicResource CardBackground}" CornerRadius="6"
                                    Padding="16">
                                <StackPanel>
                                    <TextBlock Text="Requirements" FontSize="13" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="11"
                                               Foreground="{DynamicResource TextSecondary}"
                                               Text="â€¢ Windows Server 2019+&#x0a;â€¢ .NET 8.0 Runtime&#x0a;â€¢ SQL Server Express 2022&#x0a;â€¢ 50GB+ disk space"/>
                                    <TextBlock Text="Â© 2026 GA-ASI. Internal use only." FontSize="10"
                                               Foreground="{DynamicResource TextMuted}" Margin="0,12,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!-- Generic Operation Panel (placeholder for other panels) -->
                <Border x:Name="OperationPanel"
                        automation:AutomationProperties.AutomationId="OperationPanel"
                        Visibility="{Binding IsOperationPanelVisible}">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="{Binding PageTitle}" FontSize="20"
                                   Foreground="{DynamicResource TextSecondary}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Use the left menu to run this operation. Output appears in the log panel below."
                                   Foreground="{DynamicResource TextMuted}" FontSize="13"
                                   Margin="0,8,0,0" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

            </Grid>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 LOG PANEL
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="2" Background="{DynamicResource CardBackground}"
                    BorderBrush="{DynamicResource BorderPrimary}" BorderThickness="0,1,0,0">
                <DockPanel>
                    <!-- Log Header -->
                    <Border DockPanel.Dock="Top" Background="{DynamicResource CardBackground}"
                            BorderBrush="{DynamicResource BorderPrimary}" BorderThickness="0,0,0,1"
                            Padding="12,6">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Orientation="Horizontal"
                                        VerticalAlignment="Center">
                                <TextBlock Text="Output Log" FontSize="12" FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextPrimary}" Margin="0,0,12,0"/>
                                <TextBlock Text="{Binding CurrentOperationName}"
                                           FontSize="11" Foreground="{DynamicResource TextSecondary}"
                                           Margin="0,0,12,0"/>
                                <!-- Progress bar inline with text to prevent overflow into buttons -->
                                <ProgressBar IsIndeterminate="True"
                                             Width="100" Height="3"
                                             Margin="0,0,8,0"
                                             VerticalAlignment="Center"
                                             Visibility="{Binding ProgressBarVisibility}"/>
                                <TextBlock Text="{Binding OperationStepText}"
                                           FontSize="11" Foreground="{DynamicResource TextSecondary}"
                                           VerticalAlignment="Center" MaxWidth="150"
                                           TextTrimming="CharacterEllipsis"
                                           Visibility="{Binding ProgressBarVisibility}"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="Cancel" Style="{StaticResource BtnRed}"
                                        automation:AutomationProperties.AutomationId="CancelButton"
                                        Padding="10,4" FontSize="11" Margin="0,0,8,0"
                                        Command="{Binding CancelOperationCommand}"
                                        Visibility="{Binding CancelButtonVisibility}"/>
                                <Button Content="{Binding LogToggleText}" Style="{StaticResource BtnSec}"
                                        automation:AutomationProperties.AutomationId="ToggleLogButton"
                                        Padding="10,4" FontSize="11" Margin="0,0,4,0"
                                        Command="{Binding ToggleLogPanelCommand}"/>
                                <Button Content="Clear" Style="{StaticResource BtnSec}"
                                        automation:AutomationProperties.AutomationId="ClearLogButton"
                                        Padding="10,4" FontSize="11" Margin="0,0,4,0"
                                        Command="{Binding ClearLogCommand}"/>
                                <Button Content="Save" Style="{StaticResource BtnSec}"
                                        automation:AutomationProperties.AutomationId="SaveLogButton"
                                        Padding="10,4" FontSize="11"
                                        Command="{Binding SaveLogCommand}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Status Banner (shown after operation completes) -->
                    <Border DockPanel.Dock="Top"
                            Background="{Binding StatusBannerColor}"
                            Padding="12,5"
                            Visibility="{Binding StatusBannerVisibility}">
                        <TextBlock Text="{Binding StatusBannerText}"
                                   Foreground="{DynamicResource ButtonTextPrimary}" FontSize="12"
                                   FontWeight="SemiBold"/>
                    </Border>

                    <!-- Log Text Area -->
                    <TextBox DockPanel.Dock="Bottom"
                             Style="{StaticResource LogTextBox}"
                             Text="{Binding LogOutput, Mode=OneWay}"
                             Height="{Binding LogPanelHeight}"
                             Visibility="{Binding LogTextVisibility}"
                             automation:AutomationProperties.AutomationId="LogOutputTextBox"
                             x:Name="LogTextBox"
                             TextChanged="LogTextBox_TextChanged"/>
                </DockPanel>
            </Border>

            <!-- Status Bar -->
            <Border Grid.Row="2" VerticalAlignment="Bottom"
                    Background="{DynamicResource NavBackground}"
                    Padding="12,4" Visibility="Collapsed">
                <TextBlock Text="{Binding StatusMessage}"
                           Foreground="{DynamicResource TextSecondary}" FontSize="11"/>
            </Border>

        </Grid>
    </Grid>
</Window>
