---
phase: 26-keyboard-and-accessibility
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/WsusManager.App/Views/MainWindow.xaml
  - src/WsusManager.App/Views/SettingsDialog.xaml
  - src/WsusManager.App/Views/SyncProfileDialog.xaml
  - src/WsusManager.App/Views/TransferDialog.xaml
  - src/WsusManager.App/Views/ScheduleTaskDialog.xaml
  - src/WsusManager.App/Views/InstallDialog.xaml
  - src/WsusManager.App/Views/GpoInstructionsDialog.xaml
autonomous: true
requirements:
  - UX-03

must_haves:
  truths:
    - "All interactive elements have AutomationId attributes"
    - "AutomationId names follow [Purpose][Type] PascalCase convention"
    - "UI automation tools can locate elements by AutomationId without XAML paths"
  artifacts:
    - path: "src/WsusManager.App/Views/MainWindow.xaml"
      provides: "AutomationId for all main window interactive elements"
      contains: "AutomationId=\"[Purpose][Type]\""
    - path: "src/WsusManager.App/Views/SettingsDialog.xaml"
      provides: "AutomationId for all settings controls"
      contains: "AutomationId="
    - path: "src/WsusManager.App/Views/SyncProfileDialog.xaml"
      provides: "AutomationId for sync profile controls"
      contains: "AutomationId="
  key_links:
    - from: "UI automation test scripts"
      to: "WPF controls"
      via: "AutomationId attribute lookup"
      pattern: "FindFirst.*TreeScope.*AutomationId.*[Purpose][Type]"
---

<objective>
Add AutomationId attributes to all interactive elements in MainWindow and dialog windows for UI automation testing support.

Purpose: UI automation frameworks (WinAppDriver, FlaUI, coded UI) rely on AutomationId to reliably locate elements. Without AutomationId, tests use fragile XAML path or index-based selectors that break when UI changes.
Output: All buttons, textboxes, comboboxes, listboxes, and checkboxes have descriptive AutomationId values.
</objective>

<execution_context>
@/home/anthonyscry/.claude/get-shit-done/workflows/execute-plan.md
@/home/anthonyscry/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/26-keyboard-and-accessibility/26-CONTEXT.md

@src/WsusManager.App/Views/MainWindow.xaml
@src/WsusManager.App/Views/SettingsDialog.xaml
@src/WsusManager.App/Views/SyncProfileDialog.xaml
@src/WsusManager.App/Views/TransferDialog.xaml
@src/WsusManager.App/Views/ScheduleTaskDialog.xaml
@src/WsusManager.App/Views/InstallDialog.xaml
@src/WsusManager.App/Views/GpoInstructionsDialog.xaml
</context>

<tasks>

<task type="auto">
  <name>Add AutomationId to MainWindow.xaml interactive elements</name>
  <files>src/WsusManager.App/Views/MainWindow.xaml</files>
  <action>
    Add AutomationId attributes to all interactive elements in MainWindow.xaml. Use the naming convention `[Purpose][Type]` in PascalCase:

    **Navigation Buttons** (sidebar):
    - BtnInstall → AutomationId="InstallButton"
    - BtnGpo → AutomationId="CreateGpoButton"
    - BtnTransfer → AutomationId="TransferButton"
    - BtnSync → AutomationId="OnlineSyncButton"
    - BtnSchedule → AutomationId="ScheduleTaskButton"
    - BtnDiagnostics → AutomationId="DiagnosticsButton"
    - BtnClientTools → AutomationId="ClientToolsButton"
    - BtnDatabase → AutomationId="DatabaseButton"
    - Bottom buttons → DashboardButton, SettingsButton, HelpButton, AboutButton

    **Dashboard Panel** (if not already present):
    - Computers ListBox → ComputersListBox
    - Updates TabControl → UpdatesTabControl
    - Updates ListView → UpdatesListView
    - Log panel TextBox → LogOutputTextBox
    - Clear Log button → ClearLogButton
    - Quick action buttons → RefreshHealthButton, StartServicesButton, RunCleanupButton

    **Client Tools Panel**:
    - Hostname TextBox → HostnameTextBox
    - Test Connectivity button → TestConnectivityButton
    - Remote GPUpdate button → RemoteGpUpdateButton
    - Export button → MassExportButton
    - Computers ListBox → ClientComputersListBox

    **Diagnostics Panel**:
    - All operation buttons → HealthCheckButton, RepairHealthButton, ResetContentButton
    - Output TextBox → DiagnosticsOutputTextBox

    **Database Panel**:
    - Backup button → BackupButton
    - Restore button → RestoreButton
    - Deep Cleanup button → DeepCleanupButton
    - Output TextBox → DatabaseOutputTextBox

    Add AutomationId to every Button, TextBox, ComboBox, ListBox, ListView, CheckBox, RadioButton, TabItem that is interactive. DO NOT add AutomationId to decorative elements (TextBlock labels, Separator, Border).
  </action>
  <verify>Build passes: `dotnet build src/WsusManager.App/WsusManager.App.csproj --configuration Release`</verify>
  <done>MainWindow.xaml has AutomationId on all interactive elements following [Purpose][Type] convention</done>
</task>

<task type="auto">
  <name>Add AutomationId to dialog windows</name>
  <files>
    src/WsusManager.App/Views/SettingsDialog.xaml
    src/WsusManager.App/Views/SyncProfileDialog.xaml
    src/WsusManager.App/Views/TransferDialog.xaml
    src/WsusManager.App/Views/ScheduleTaskDialog.xaml
    src/WsusManager.App/Views/InstallDialog.xaml
    src/WsusManager.App/Views/GpoInstructionsDialog.xaml
  </files>
  <action>
    For each dialog XAML file, add AutomationId attributes following the [Purpose][Type] convention:

    **Dialog Root**:
    - Root Window/Border gets AutomationId="[DialogName]Dialog" (e.g., "SettingsDialog", "SyncProfileDialog")

    **Settings Dialog** (SettingsDialog.xaml):
    - TabControl → SettingsTabControl
    - General tab → GeneralTabItem
    - Appearance tab → AppearanceTabItem
    - Save button → SaveSettingsButton
    - Cancel button → CancelSettingsButton
    - All input controls → ServerModeComboBox, DefaultSyncProfileComboBox, ThemeComboBox, etc.

    **Sync Profile Dialog** (SyncProfileDialog.xaml):
    - Profile ComboBox → SyncProfileComboBox
    - OK button → OkSyncProfileButton
    - Cancel button → CancelSyncProfileButton

    **Transfer Dialog** (TransferDialog.xaml):
    - Direction ComboBox → TransferDirectionComboBox
    - Source path TextBox/Browse → ExportSourcePathTextBox, BrowseSourceButton
    - Destination path TextBox/Browse → ExportDestinationPathTextBox, BrowseDestinationButton
    - Export days TextBox → ExportDaysTextBox
    - Start button → StartTransferButton
    - Cancel button → CancelTransferButton

    **Schedule Task Dialog** (ScheduleTaskDialog.xaml):
    - Profile ComboBox → ScheduleProfileComboBox
    - Schedule type ComboBox → ScheduleTypeComboBox
    - Day of month NumericUpDown → DayOfMonthNumericUpDown
    - Username TextBox → ScheduleUsernameTextBox
    - Password TextBox → SchedulePasswordBox
    - Create button → CreateScheduleButton
    - Cancel button → CancelScheduleButton

    **Install Dialog** (InstallDialog.xaml):
    - SQL path TextBox → SqlPathTextBox
    - Browse button → BrowseSqlPathButton
    - Install button → StartInstallButton
    - Cancel button → CancelInstallButton

    **GPO Instructions Dialog** (GpoInstructionsDialog.xaml):
    - Copy button → CopyGpoFilesButton
    - Close button → CloseGpoInstructionsButton

    Apply AutomationId to ALL interactive controls in each dialog.
  </action>
  <verify>Build passes: `dotnet build src/WsusManager.App/WsusManager.App.csproj --configuration Release`</verify>
  <done>All dialog XAML files have AutomationId on interactive elements following [Purpose][Type] convention</done>
</task>

<task type="auto">
  <name>Create AutomationId verification test</name>
  <files>Tests/WsusManager.App.Tests/AutomationIdTests.cs</files>
  <action>
    Create a test file that verifies critical AutomationId values exist. Create `Tests/WsusManager.App.Tests/AutomationIdTests.cs`:

    ```csharp
    using System.Windows.Automation;
    using System.Windows;
    using Xunit;
    using WsusManager.App.Views;

    namespace WsusManager.App.Tests;

    public class AutomationIdTests
    {
        [Fact]
        public void MainWindow_ShouldHaveCriticalAutomationIds()
        {
            // This test verifies the XAML compiles with AutomationId attributes.
            // Full runtime verification requires UI automation test frameworks.
            // For now, we verify the file contains expected AutomationId values.

            var mainWindowXaml = File.ReadAllText(
                Path.Combine("src", "WsusManager.App", "Views", "MainWindow.xaml"));

            Assert.Contains("AutomationId=\"InstallButton\"", mainWindowXaml);
            Assert.Contains("AutomationId=\"SettingsButton\"", mainWindowXaml);
            Assert.Contains("AutomationId=\"HelpButton\"", mainWindowXaml);
            Assert.Contains("AutomationId=\"ComputersListBox\"", mainWindowXaml);
            Assert.Contains("AutomationId=\"LogOutputTextBox\"", mainWindowXaml);
        }

        [Theory]
        [InlineData("SettingsDialog.xaml", "SettingsDialog", "SaveSettingsButton")]
        [InlineData("SyncProfileDialog.xaml", "SyncProfileDialog", "OkSyncProfileButton")]
        [InlineData("TransferDialog.xaml", "TransferDialog", "StartTransferButton")]
        public void Dialogs_ShouldHaveCriticalAutomationIds(string filename, string dialogId, string buttonId)
        {
            var dialogXaml = File.ReadAllText(
                Path.Combine("src", "WsusManager.App", "Views", filename));

            Assert.Contains($"AutomationId=\"{dialogId}\"", dialogXaml);
            Assert.Contains($"AutomationId=\"{buttonId}\"", dialogXaml);
        }
    }
    ```

    This test performs compile-time verification by checking XAML file contents. Full UI automation tests would require WinAppDriver or FlaUI setup (deferred).
  </action>
  <verify>Run tests: `dotnet test Tests/WsusManager.App.Tests/WsusManager.App.Tests.csproj --filter "FullyQualifiedName~AutomationIdTests"` passes</verify>
  <done>AutomationIdTests.cs created with tests verifying critical AutomationId values in XAML files</done>
</task>

</tasks>

<verification>
Overall phase checks:
1. Build succeeds: `dotnet build src/WsusManager.App/WsusManager.App.csproj --configuration Release`
2. All tests pass: `dotnet test Tests/WsusManager.App.Tests/WsusManager.App.Tests.csproj`
3. Verify with UI automation tool (optional): Use UIAVerify or Inspect.exe to confirm AutomationId values are exposed
</verification>

<success_criteria>
1. All Button elements in MainWindow.xaml have AutomationId
2. All TextBox, ComboBox, ListBox controls in MainWindow.xaml have AutomationId
3. All dialog windows have AutomationId on root element
4. All interactive controls in dialogs have AutomationId
5. AutomationId names follow [Purpose][Type] PascalCase convention
</success_criteria>

<output>
After completion, create `.planning/phases/26-keyboard-and-accessibility/26-02-SUMMARY.md`
</output>
